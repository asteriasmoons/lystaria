---
// No props needed for now
---

<div id="install-prompt" class="install-prompt">
  <div class="install-content">
    <button class="close-prompt" aria-label="Close">×</button>
    <div class="install-text">
      <span class="install-emoji">✨</span>
      <p>Add Lystaria to your home screen for quick access</p>
    </div>
    <div class="install-instructions">
      <p>
        Tap <svg
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          ><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8"></path><polyline
            points="16 6 12 2 8 6"></polyline><line
            x1="12"
            y1="2"
            x2="12"
            y2="15"></line></svg
        > then "Add to Home Screen"
      </p>
    </div>
  </div>
</div>

<style>
  .install-prompt {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, #7e7eff 0%, #5ac8fa 100%);
    padding: 1rem;
    transform: translateY(100%);
    transition: transform 0.3s ease;
    z-index: 9999;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
  }

  .install-prompt.show {
    transform: translateY(0);
  }

  .install-content {
    position: relative;
    max-width: 600px;
    margin: 0 auto;
  }

  .close-prompt {
    position: absolute;
    top: -8px;
    right: 0;
    background: transparent;
    border: none;
    color: white;
    font-size: 2rem;
    cursor: pointer;
    line-height: 1;
    padding: 0;
    width: 32px;
    height: 32px;
  }

  .install-text {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
  }

  .install-emoji {
    font-size: 1.5rem;
  }

  .install-text p {
    margin: 0;
    color: white;
    font-size: 1rem;
    font-weight: 500;
  }

  .install-instructions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .install-instructions p {
    margin: 0;
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.875rem;
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }

  .install-instructions svg {
    display: inline-block;
    vertical-align: middle;
  }
</style>

<script>
  // Only show on iOS Safari, only if not already installed
  function shouldShowPrompt() {
    // Check if iOS
    const isIOS =
      /iPad|iPhone|iPod/.test(navigator.userAgent) && !(window as any).MSStream;
    if (!isIOS) return false;

    // Check if Safari (not Chrome/Firefox on iOS)
    const isSafari =
      /Safari/.test(navigator.userAgent) &&
      !/CriOS|FxiOS/.test(navigator.userAgent);
    if (!isSafari) return false;

    // Check if already installed
    if (window.matchMedia("(display-mode: standalone)").matches) return false;
    if ((navigator as any).standalone) return false;

    // Check if user dismissed before
    if (localStorage.getItem("installPromptDismissed")) return false;

    return true;
  }

  function showInstallPrompt() {
    if (!shouldShowPrompt()) return;

    const prompt = document.getElementById("install-prompt");
    if (!prompt) return;

    // Show after 3 seconds on page
    setTimeout(() => {
      prompt.classList.add("show");
    }, 3000);

    // Close button
    const closeBtn = prompt.querySelector(".close-prompt");
    closeBtn?.addEventListener("click", () => {
      prompt.classList.remove("show");
      localStorage.setItem("installPromptDismissed", "true");
    });
  }

  // Run on page load
  showInstallPrompt();
</script>
